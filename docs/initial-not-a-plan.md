<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# План реализации с тестируемыми этапами

## Фаза 1: Базовая инфраструктура и простейший health-check (3-4 дня)

**Результат:** Работающий API с одной endpoint и тестами

**Backend:**

- Инициализация FastAPI проекта с Docker
- Подключение PostgreSQL и создание первой миграции
- Health-check endpoint: GET /health - возвращает {"status": "ok", "timestamp": "..."}
- Настройка pytest с одним тестом для health-check
- Docker-compose для локального запуска

**Тесты результата:**

- curl http://localhost:8000/health - должен вернуть 200 OK
- pytest - должен пройти 1 тест
- docker-compose up - все сервисы стартуют без ошибок


## Фаза 2: Пользователи и JWT-авторизация (5-7 дней)

**Результат:** Полноценная регистрация/авторизация с защищенным endpoint

**Backend:**

- Модель User в SQLAlchemy
- POST /auth/register - регистрация (email, password)
- POST /auth/login - получение JWT токена
- GET /auth/me - получение данных пользователя (требует токен)
- Middleware для проверки JWT токена
- Хеширование паролей с помощью passlib

**Frontend:**

- Минималистичная React-app с двумя формами
- Форма регистрации
- Форма входа
- Страница профиля (показывает email залогиненного пользователя)
- Сохранение JWT токена в localStorage

**Тесты результата:**

- Регистрируем пользователя через форму - success
- Логинимся - получаем токен и переходим в профиль
- Обновляем страницу - остаемся залогиненными
- curl с токеном к /auth/me - возвращает данные пользователя
- curl без токена к /auth/me - возвращает 401


## Фаза 3: Справочник сфер жизни и создание сессии (4-5 дней)

**Результат:** Можем создать пустую сессию оценки и увидеть 8 сфер жизни

**Backend:**

- Модель LifeArea - справочник с 8 сферами на русском/английском
- Миграция для заполнения справочника
- Модель AssessmentSession
- GET /life-areas - получить все сферы
- POST /sessions - создать новую сессию (статус: draft)
- GET /sessions/current - получить текущую незавершенную сессию

**Frontend:**

- Страница "Новая оценка" со списком 8 сфер
- Кнопка "Начать оценку" - создает сессию и показывает ее ID
- После создания сессии показываем сферы с placeholder'ами для оценок

**Тесты результата:**

- Заходим в "Новая оценка" - видим 8 сфер жизни
- Нажимаем "Начать оценку" - создается сессия, видим ее ID на странице
- curl GET /life-areas - возвращает 8 записей с именами
- curl POST /sessions с токеном - создает сессию и возвращает ID


## Фаза 4: Выставление оценок по сферам (3-4 дня)

**Результат:** Можем поставить оценки всем сферам и сохранить их

**Backend:**

- Модель SessionScore
- PUT /sessions/{id}/scores - принимает массив из 8 оценок и сохраняет их
- GET /sessions/{id} - возвращает сессию с оценками

**Frontend:**

- 8 слайдеров от 1 до 10 для каждой сферы
- Кнопка "Сохранить оценки" - отправляет все оценки одним запросом
- После сохранения показываем успешное сообщение

**Тесты результата:**

- Выставляем оценки всем 8 сферам через слайдеры
- Нажимаем "Сохранить" - оценки сохраняются
- Обновляем страницу - оценки остались на местах
- curl GET /sessions/{id} - возвращает сессию со всеми оценками


## Фаза 5: Завершение сессии и история (3-4 дня)

**Результат:** Можем завершать сессии и просматривать историю

**Backend:**

- POST /sessions/{id}/complete - завершает сессию (is_completed = true)
- GET /sessions - возвращает список всех сессий пользователя

**Frontend:**

- Кнопка "Завершить оценку" - завершает сессию и перенаправляет в историю
- Страница "История" со списком всех завершенных сессий
- Клик по сессии показывает детали (дата, оценки по сферам)

**Тесты результата:**

- Создаем сессию, выставляем оценки, завершаем - сессия появляется в истории
- В истории видим дату и можем открыть детали сессии
- Создаем вторую сессию - в истории видим обе
- curl GET /sessions - возвращает список завершенных сессий


## Фаза 6: Простая круговая диаграмма (4-5 дней)

**Результат:** Визуальное представление текущей оценки в виде круга

**Frontend:**

- Подключаем Chart.js + react-chartjs-2
- Компонент LifeWheelChart - круговая диаграмма с 8 осями
- На странице детали сессии показываем диаграмму
- На главной странице показываем диаграмму последней сессии

**Тесты результата:**

- Завершенная сессия отображается как круговая диаграмма
- На каждой оси видим название сферы и значение оценки
- Меняем оценки в новой сессии - диаграмма перерисовывается
- Диаграмма визуально корректно отображает различия между высокими и низкими оценками


## Фаза 7: Создание проблем по сферам (5-6 дней)

**Результат:** Можем добавлять проблемы к каждой сфере жизни

**Backend:**

- Модель Problem
- POST /life-areas/{id}/problems - создать проблему для сферы
- GET /life-areas/{id}/problems - получить проблемы сферы (макс. 8)
- PUT /problems/{id} - редактировать проблему
- DELETE /problems/{id} - удалить проблему

**Frontend:**

- Страница "Проблемы" с выбором сферы жизни
- Для выбранной сферы список проблем (изначально пустой)
- Форма добавления проблемы (текстовое поле)
- Возможность редактировать/удалять проблемы
- Валидация: максимум 8 проблем на сферу

**Тесты результата:**

- Выбираем сферу "Здоровье", добавляем проблему "Мало сплю" - проблема сохраняется
- Редактируем проблему - изменения сохраняются
- Пытаемся добавить 9-ю проблему - получаем ошибку
- Удаляем проблему - она исчезает из списка
- curl POST /life-areas/{id}/problems - создает проблему


## Фаза 8: Создание решений для проблем (4-5 дней)

**Результат:** К каждой проблеме можем добавлять решения с первым шагом

**Backend:**

- Модель Solution
- POST /problems/{id}/solutions - создать решение для проблемы
- GET /problems/{id}/solutions - получить решения проблемы
- PUT /solutions/{id} - редактировать решение
- DELETE /solutions/{id} - удалить решение

**Frontend:**

- На странице проблем клик по проблеме показывает ее решения
- Форма добавления решения: описание решения + первый шаг
- Список решений с возможностью редактирования/удаления

**Тесты результата:**

- Для проблемы "Мало сплю" добавляем решение "Ложиться в 22:00" с первым шагом "Поставить будильник на 21:45"
- Решение сохраняется и отображается
- Редактируем решение - изменения сохраняются
- Удаляем решение - оно исчезает
- curl GET /problems/{id}/solutions - возвращает список решений


## Фаза 9: Локализация русский/английский (3-4 дня)

**Результат:** Интерфейс полностью переводится между русским и английским

**Backend:**

- Поле language в модели User
- PUT /users/me/language - смена языка пользователя
- GET /life-areas возвращает названия на нужном языке

**Frontend:**

- Подключаем react-i18next
- Файлы локализации ru.json и en.json
- Переключатель языка в профиле пользователя
- Весь интерфейс переводится

**Тесты результата:**

- Регистрируемся - интерфейс на русском по умолчанию
- Переключаем на английский - весь интерфейс переводится
- Создаем сессию на английском - сферы жизни называются по-английски
- Обновляем страницу - язык сохраняется
- curl GET /life-areas с разными языками - названия приходят на нужном языке


## Фаза 10: Покрытие тестами 80%+ (4-5 дней)

**Результат:** Стабильность системы подтверждена тестами

**Backend:**

- Unit-тесты для всех сервисов
- Integration-тесты для всех API endpoints
- Fixture'ы для тестовых данных
- Тесты на граничные случаи (макс. 8 проблем, валидация токенов)

**Frontend:**

- Unit-тесты для ключевых компонентов
- Тесты для хуков
- Тесты для утилит локализации и API

**Тесты результата:**

- pytest --cov показывает покрытие 80%+
- npm test показывает успешное прохождение тестов фронтенда
- CI pipeline проходит без ошибок
- Система работает стабильно после рефакторинга


## Критерии завершения каждой фазы

**Для каждой фазы обязательно:**

1. Все новые endpoints работают через curl/Postman
2. UI изменения видны и функциональны в браузере
3. Написаны и проходят тесты для новой функциональности
4. Docker-compose up поднимает систему без ошибок
5. Нет регрессии предыдущего функционала

**Демо после каждой фазы:**

- Показываем работающий функционал через UI
- Демонстрируем API через curl/Postman
- Прогоняем тесты и показываем их результаты

